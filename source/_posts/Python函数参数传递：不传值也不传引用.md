---
title: Python函数参数传递：不传值也不传引用
date: 2017-03-22 23:50:12
tags: Python
categories: Python学习之路
description:
---


Python中由于一切皆对象，函数的参数传递与其他语言也有很大的区别。对于有C/C++基础的同学，刚接触Python都会问一个问题：Python中函数参数的传递，到底是传值还是传引用？

<!--more-->

## 引子

在回答这个问题前，首先看一个例子。

```python
def change(val):
    val.append(100)
    val = ['a', 'b', 'c']

nums = [0, 1]
change(nums)
print(nums)
```
这段代码的输出是什么呢？

按照C++语言的思维，如果是传值的话，结果应该没有改变，还是`[0, 1]`；如果是传引用的话，结果应该是`['a', 'b', 'c']`。

但实际输出是`[0, 1, 100]`。所以，好像Python中既不是传值也不是传引用？

要想通这个问题，需要对Python中的变量和对象有一个清楚的认识。再看几个例子。

## 变量和对象

首先明确一些概念：Python中的**变量和对象**。

Python中的变量是没有类型的，我们可以把它看做一个`(*void)`类型的指针，变量是可以指向任何对象的(也可以看成是对象的名字)，而对象才是有类型的。

比如下面的例子：
```python
>>>nums = (1, 2, 3)
>>>type(nums) 	
tuple
>>>id(nums)
59179256
>>>nums = [1, 2, 3] 
>>>type(nums)
list
>>>id(nums)
59094960
```
可以看到`nums`这个变量是没有类型的，它可以指向一个tuple，也可以指向一个list。它(nums)就像一个名字，我可以叫这个名字，你也可以叫这个名字，但是我们之间只能一个人叫这个名字，而我们就是两个不同的对象。

明白了这个概念，就大概了解了**Python中函数参数传递的是变量的值，即变量所指向的对象的地址**。

乍一听，咦，这不就是引用传递吗？

这就牵扯到可变与不可变对象的概念了。Python中的对象有可变对象和不可变对象之分，详见[如何理解Python中的可变对象与不可变对象](https://chown-jane-y.github.io/2017/03/22/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3Python%E4%B8%AD%E7%9A%84%E5%8F%AF%E5%8F%98%E5%AF%B9%E8%B1%A1%E4%B8%8E%E4%B8%8D%E5%8F%AF%E5%8F%98%E5%AF%B9%E8%B1%A1/)。

对于可变对象与不可变对象的参数传递，一般有如下规律：
- 不可变对象作为函数参数，相当于C系语言的值传递。
- 可变对象作为函数参数，相当于C系语言的引用传递。 

以上规律是正确的，对于学过C/C++的同学来说，一定要类比的话，可以这么来类比。但是Python中，其实是不存在传值或传引用这一说的！准确的来说，Python中函数传递的都是对象(call by objects)。由于对象分为可变与不可变，才会出现类似于传值或传引用的现象。

## 几个例子

### 不可变对象

```python
def change(val):
    val = 0
    
num = 1
change(num)
print(num)	 	# 输出结果为1
```
我们定义了一个变量`num`，`num`指向数字1，然后执行`change`函数进行参数传递的时候，`num`指向的对象地址传给了`val`，因此`val`也指向了1。进入函数体后，函数体中给`val`赋值0，因为整型是不可变对象，所以`val`重新指向了0所在的内存地址，而不是把原来的1改成0。此时作为`num`变量，仍然指向1。 

![immutable](http://i1.piimg.com/588729/63c2e95add41958d.png)



### 可变对象

```python
def change(val):
    val.append(1)
nums = [0]
change(nums)
print(nums)
```
这里`nums`是一个list，是可变对象，所以可以直接在原来的内存空间内修改。调用`change`函数进行参数传递时，`val`指向列表`[0]`，因为列表是可变对象，所以给`[0]`执行`append`操作的时候，**直接作用在原来的list上不会生成新的对象**，所以返回结果是`[0, 1]`。

![mutable](http://i1.piimg.com/588729/35fe5cc93e018026.png)



最后回到引子的那个问题。

开始的时候，`nums`指向列表`[0, 1]`，然后传递参数时，`val`指向列表`[0, 1]`，然后执行`append`，列表`[0, 1]`变成`[0, 1, 100]`，然后又将`['a', 'b', 'c']`赋值给`val`，所以最后的结果是`val`指向了`['a', 'b', 'c']`，而`nums`指向的`[0, 1]`变成了`[0, 1, 100]`。


![yinzi](http://i1.piimg.com/588729/aec345ed83ef9db0.png)


---

[参考]
http://blog.csdn.net/theonegis/article/details/51013079

<!--more-->